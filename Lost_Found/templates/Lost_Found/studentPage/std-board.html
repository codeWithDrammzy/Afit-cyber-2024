{% extends 'Lost_Found/main.html' %}
{% block content %}

<div class="p-4 md:p-6">
    <!-- Welcome Card -->
    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-5 mb-6 border border-blue-100">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between">
            <div>
                <h1 class="text-2xl font-bold text-gray-800 mb-1">Hello, {{ user.first_name|default:"Student" }}! üëã</h1>
                <p class="text-gray-600">Welcome to Campus Lost & Found System</p>
            </div>
            
            <!-- Student Badge -->
            <div class="mt-4 md:mt-0 bg-white rounded-xl px-4 py-2 border border-blue-200">
                <p class="text-xs text-gray-500">Student ID</p>
                <p class="font-mono font-semibold text-gray-800">
                    {% if user.student.matric_no %}
                        {{ user.student.matric_no }}
                    {% else %}
                        {{ user.username }}
                    {% endif %}
                </p>
            </div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
        <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-gray-500">Active Reports</p>
                    <p class="text-2xl font-bold text-blue-600 mt-1">{{ active_reports }}</p>
                </div>
                <div class="text-blue-500">
                    <i class="fas fa-bullhorn text-xl"></i>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">Your ongoing reports</p>
        </div>
        
        <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-gray-500">Items Found</p>
                    <p class="text-2xl font-bold text-green-600 mt-1">{{ items_found }}</p>
                </div>
                <div class="text-green-500">
                    <i class="fas fa-check-circle text-xl"></i>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">Items you've reported found</p>
        </div>
        
        <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-gray-500">Pending Claims</p>
                    <p class="text-2xl font-bold text-yellow-600 mt-1">{{ pending_claims }}</p>
                </div>
                <div class="text-yellow-500">
                    <i class="fas fa-clock text-xl"></i>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">Awaiting pickup</p>
        </div>
        
        <div class="bg-white rounded-xl p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-xs text-gray-500">Resolved Cases</p>
                    <p class="text-2xl font-bold text-purple-600 mt-1">{{ resolved_cases }}</p>
                </div>
                <div class="text-purple-500">
                    <i class="fas fa-trophy text-xl"></i>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">Successfully resolved</p>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="mb-8">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Quick Actions</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Report Lost Item -->
            <div class="bg-gradient-to-r from-red-50 to-orange-50 rounded-xl border border-red-100 p-5 hover:shadow-md transition-all">
                <div class="flex items-start space-x-4">
                    <div class="bg-red-100 text-red-600 w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-exclamation-triangle text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="font-bold text-gray-800 text-lg mb-2">Report Lost Item</h3>
                        <p class="text-gray-600 text-sm mb-4">Missing something? Report it so others can help find it.</p>
                        <a href="{% url 'report-item' %}" class="block w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors text-center">
                            <i class="fas fa-plus-circle mr-2"></i>Report Now
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Report Found Item -->
            <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100 p-5 hover:shadow-md transition-all">
                <div class="flex items-start space-x-4">
                    <div class="bg-green-100 text-green-600 w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-hand-holding-heart text-xl"></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="font-bold text-gray-800 text-lg mb-2">Report Found Item</h3>
                        <p class="text-gray-600 text-sm mb-4">Found someone's belongings? Help return them.</p>
                        <a href="{% url 'report-item' %}" class="block w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors text-center">
                            <i class="fas fa-plus-circle mr-2"></i>Report Now
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- My Recent Reports -->
    {% if user_recent_items %}
    <div class="mb-8">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">My Recent Reports</h2>
            <a href="" class="text-blue-600 text-sm font-medium hover:text-blue-800">View All ‚Üí</a>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {% for item in user_recent_items %}
            <div class="bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow">
                <div class="flex items-start space-x-3">
                    <div class="w-16 h-16 {% if item.status == 'found' %}bg-green-100{% elif item.status == 'lost' %}bg-red-100{% else %}bg-blue-100{% endif %} rounded-lg flex items-center justify-center flex-shrink-0">
                        {% if item.category == 'electronics' %}
                        <i class="fas fa-laptop {% if item.status == 'found' %}text-green-600{% elif item.status == 'lost' %}text-red-600{% else %}text-blue-600{% endif %} text-xl"></i>
                        {% elif item.category == 'documents' %}
                        <i class="fas fa-file-alt {% if item.status == 'found' %}text-green-600{% elif item.status == 'lost' %}text-red-600{% else %}text-blue-600{% endif %} text-xl"></i>
                        {% elif item.category == 'clothing' %}
                        <i class="fas fa-tshirt {% if item.status == 'found' %}text-green-600{% elif item.status == 'lost' %}text-red-600{% else %}text-blue-600{% endif %} text-xl"></i>
                        {% elif item.category == 'accessories' %}
                        <i class="fas fa-key {% if item.status == 'found' %}text-green-600{% elif item.status == 'lost' %}text-red-600{% else %}text-blue-600{% endif %} text-xl"></i>
                        {% elif item.category == 'books' %}
                        <i class="fas fa-book {% if item.status == 'found' %}text-green-600{% elif item.status == 'lost' %}text-red-600{% else %}text-blue-600{% endif %} text-xl"></i>
                        {% else %}
                        <i class="fas fa-box {% if item.status == 'found' %}text-green-600{% elif item.status == 'lost' %}text-red-600{% else %}text-blue-600{% endif %} text-xl"></i>
                        {% endif %}
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-gray-800 truncate">{{ item.title }}</h3>
                            <span class="px-2 py-1 {% if item.status == 'found' %}bg-green-100 text-green-700{% elif item.status == 'lost' %}bg-red-100 text-red-700{% else %}bg-blue-100 text-blue-700{% endif %} rounded text-xs font-medium">
                                {{ item.get_status_display|upper }}
                            </span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">
                            üìç 
                            {% if item.status == 'found' %}
                                {{ item.location_found|default:"Location not specified" }}
                            {% elif item.status == 'lost' %}
                                {{ item.location_lost|default:"Location not specified" }}
                            {% endif %}
                        </p>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-500 text-xs">
                                {% if item.status == 'found' %}
                                    Found: {{ item.date_occurred|date:"M d, Y" }}
                                {% elif item.status == 'lost' %}
                                    Lost: {{ item.date_occurred|date:"M d, Y" }}
                                {% endif %}
                            </span>
                            <a href="" class="text-blue-600 hover:text-blue-800 text-sm font-medium">View Details ‚Üí</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Recently Found Items (From Others) -->
    {% if recently_found_items %}
    <div class="mb-8">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">Recently Found Items</h2>
            <a href="{% url 'found-item' %}" class="text-blue-600 text-sm font-medium hover:text-blue-800">Browse All ‚Üí</a>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {% for item in recently_found_items %}
            <div class="bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow">
                <div class="flex items-start space-x-3">
                    <div class="w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                        {% if item.category == 'electronics' %}
                        <i class="fas fa-laptop text-green-600 text-xl"></i>
                        {% elif item.category == 'documents' %}
                        <i class="fas fa-file-alt text-green-600 text-xl"></i>
                        {% elif item.category == 'clothing' %}
                        <i class="fas fa-tshirt text-green-600 text-xl"></i>
                        {% elif item.category == 'accessories' %}
                        <i class="fas fa-key text-green-600 text-xl"></i>
                        {% elif item.category == 'books' %}
                        <i class="fas fa-book text-green-600 text-xl"></i>
                        {% else %}
                        <i class="fas fa-box text-green-600 text-xl"></i>
                        {% endif %}
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-gray-800 truncate">{{ item.title }}</h3>
                            <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">FOUND</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">
                            üìç {{ item.location_found|default:"Location not specified" }}
                        </p>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-500 text-xs">
                                Found: {{ item.date_occurred|date:"M d, Y" }}
                                {% if item.reported_by != user %}
                                    by {{ item.reported_by.first_name|default:item.reported_by.username }}
                                {% endif %}
                            </span>
                            <a href="" class="text-blue-600 hover:text-blue-800 text-sm font-medium">View Details ‚Üí</a>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-span-2 text-center py-8">
                <i class="fas fa-inbox text-gray-300 text-4xl mb-3"></i>
                <p class="text-gray-500">No recently found items by others</p>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate stat counters
    const counters = document.querySelectorAll('.text-2xl.font-bold');
    
    counters.forEach(counter => {
        const finalValue = parseInt(counter.textContent) || 0;
        let currentValue = 0;
        const increment = finalValue / 20;
        const duration = 800;
        const stepTime = duration / 20;
        
        const timer = setInterval(() => {
            currentValue += increment;
            if (currentValue >= finalValue) {
                counter.textContent = finalValue;
                clearInterval(timer);
            } else {
                counter.textContent = Math.floor(currentValue);
            }
        }, stepTime);
    });
    
    // Add hover effects to stat cards
    const statCards = document.querySelectorAll('.bg-white.rounded-xl');
    statCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-2px)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
});
</script>

<style>
    /* Smooth transitions */
    .transition-shadow {
        transition: box-shadow 0.3s ease;
    }

    .transition-all {
        transition: all 0.3s ease;
    }

    /* Truncate long text */
    .truncate {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    /* Card hover effects */
    .hover\:shadow-md:hover {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    /* Gradient backgrounds */
    .bg-gradient-to-r {
        background-size: 200% 200%;
        animation: gradient 3s ease infinite;
    }

    @keyframes gradient {
        0% {
            background-position: 0% 50%;
        }
        50% {
            background-position: 100% 50%;
        }
        100% {
            background-position: 0% 50%;
        }
    }
</style>

{% endblock %}